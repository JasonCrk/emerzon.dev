---
import Navbar from '../components/Navbar/Navbar.astro'
import ToggleTheme from '../components/ToggleTheme/ToggleTheme.astro'
import TranslateButton from '../components/TranslateButton/TranslateButton.astro'

import { getLangFromUrl } from '../i18n/utils'

interface Props {
    title: string
}

const { title } = Astro.props

const lang = getLangFromUrl(Astro.url)
---

<html class="dark" lang={lang}>
    <head>
        <meta charset="utf-8" />
        <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
        <meta name="viewport" content="width=device-width" />
        <meta name="generator" content={Astro.generator} />
        <title>Emerzon Kolki - {title}</title>
    </head>
    <body>
        <header>
            <TranslateButton />
            <Navbar />
            <ToggleTheme />
        </header>

        <slot />
    </body>
</html>

<script is:inline>
    const html = document.querySelector('html')

    const themeMode = window.localStorage.getItem('themeMode')

    if (themeMode === 'light') {
        html?.classList.add('light')
        html?.classList.remove('dark')
    } else if (themeMode === 'dark') {
        html?.classList.add('dark')
        html?.classList.remove('light')
    } else {
        const browserDarkScheme = window.matchMedia(
            '(prefers-color-scheme: dark)',
        ).matches

        if (browserDarkScheme) {
            html?.classList.add('dark')
            html?.classList.remove('light')
        } else {
            html?.classList.add('light')
            html?.classList.remove('dark')
        }
    }
</script>

<style is:global>
    @import '../styles/normalize.css';
    @import '../styles/global.css';
    @import '../styles/variables.css';

    header {
        top: 20px;
        left: 0px;
        width: 100%;
        padding-inline: 30px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        position: fixed;
    }
</style>
